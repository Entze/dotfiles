{{ if (and (eq .chezmoi.osRelease.id "debian") (eq .chezmoi.osRelease.versionCodename "trixie")) -}}
#!/usr/bin/env bash

sudo apt-get update --yes

{{- range .packages -}}

{{- range . -}}

{{- if (and (hasKey . "debian") (hasKey .debian "trixie")) }}

if ! command -v {{ .debian.trixie.command | quote }} 2>&1 >/dev/null; then

  {{ if hasKey .debian.trixie "before" -}}
  {{ .debian.trixie.before }}
  {{- end }}

  sudo apt-get install --yes {{ .debian.trixie.package | quote }}

  {{ if hasKey .debian.trixie "after" -}}
  {{ .debian.trixie.after }}
  {{- end }}

fi

{{- else if (hasKey . "bootstrap" )}}

if ! command -v {{ .bootstrap.command | quote }} 2>&1 >/dev/null; then

  {{ .bootstrap.package }}

fi

{{- else if (hasKey . "mise") }}

if ! command -v {{ .mise.command | quote }} 2>&1 >/dev/null; then

  {{ if hasKey .mise "before" -}}
  {{ .mise.before }}
  {{- end }}

  mise use --global --yes {{ .mise.package | quote }}

  {{ if hasKey .mise "after" -}}
  {{ .mise.after }}
  {{- end }}

fi
{{- end -}}
{{- end -}}
{{- end -}}
{{- end }}
